<style>
    #pano1, 
    #pano2 {
        margin-top: 20px;
        height: 560px;
        background-position: 0 center;
        cursor: ew-resize;
        position:relative;
    }
    #pano1 {
        background-image: url(//codecloud.cdn.speedyrails.net/sites/581a35806e6f6446b0080000/image/jpeg/1477658392000/CentreCourt_Final.jpg);
    }
    #pano2 {
        background-image: url(//codecloud.cdn.speedyrails.net/sites/581a35806e6f6446b0080000/image/jpeg/1477658428000/FoodCourt_Final.jpg);
    }
    .site_content_container{
        background: none;
    }
    .col-md-6{
        margin-top: 20px;
    }
    .trend-holder-img{
        margin-top: 28px;
        margin-bottom: 28px;
    }
    #trend-navi {
      text-align: center;
    }
    #trend-navi img {
      margin-left: 10px;
      margin-right: 10px;
      margin-bottom: 20px;
    }
    
    .trend-item img {
        width: 100%;
      max-height: 100%;
      margin-top: 0px;
      margin-bottom: 0px;
    }
    
    .inside_pano{
        color: #fff;
        background: rgba(0,0,0,.5);
        display: inline-block;
        padding: 20px 17px;
        border-radius: 410px;
        position: absolute;
        right: 15px;
        top: 15px;
    }
    @media(max-width:768px){
        #pano1, #pano2 {
            height:400px;  
        }
    }
</style>

<div class="position_relative page_header margin_bottom_none">
    <div class="page_heading"></div>
</div>
<div class="content_container" style="min-height:600px">
    <h4 class="page_heading2">Gallery</h4>
    <br>
    <p>VIRTUAL TOUR Click and drag the photos below to view the new Centre Court and Food Court</p>
    <br>
    <blockquote data-width="100%" data-height="630px" class="ricoh-theta-spherical-image" >Post from RICOH THETA. - <a href="https://theta360.com/s/cctqBL7UQ1IaM5geCCEwuwU4W" target="_blank">Spherical Image - RICOH THETA</a></blockquote>
<script async src="https://theta360.com/widgets.js" charset="utf-8"></script>
    <br><br>
    <blockquote data-width="100%" data-height="630" class="ricoh-theta-spherical-image" >Post from RICOH THETA. - <a href="https://theta360.com/s/oWoQ2OKQIBsIZPRThjNhb2uwq" target="_blank">Spherical Image - RICOH THETA</a></blockquote>
<script async src="https://theta360.com/widgets.js" charset="utf-8"></script>
    
    
    <div class="trend-holder-img" id="trend-holders">
        <script id="trend_holder_template" type="x-tmpl-mustache">
            <div class="trend-item" id="redevelopment{{redevelopment_id}}" style="{{showItem}}">
                <img alt="" src="{{photo_source}}" />
            </div>
        </script>
    </div>
      <div class="trend-navi" id="trend-navi">
        <script id="trend_template" type="x-tmpl-mustache">
            <a href="#redevelopment{{redevelopment_id}}">
                <img alt="redevelopment" height="132" src="{{photo_source}}" width="198" />
            </a>
        </script>
    </div>

</div>
<script src="//s3.amazonaws.com/kodekloud/sites/581a35806e6f6446b0080000/text/javascript/1428378892000/jquery.cyclotron.min.js"></script>
<script>
    $(document).ready(function(){
       init();
       
       function renderAll (){
            var fashions = getFashions();
            renderTrendReport('#trend_template', '#trend-navi', fashions);            
            renderTrendReport('#trend_holder_template', '#trend-holders', fashions);
            renderpageHTML();
            contentSwitcher();
            $('.cycle').cyclotron();
            
        }
        
        function renderTrendReport(trend_template, trend_item, fashionItems){
            var item_list = [];
            var trend_template_html = $(trend_template).html();
            Mustache.parse(trend_template_html);
            var count = 0;
            $.each( fashionItems , function( key, val ) {  
                if( val.name == "Redevelopment"){
                    $.each( val.fashion_images , function( key, val ) {
                        if (count > 0){
                            val.showItem = 'display:none;'; 
                        }
                        val.redevelopment_id = count + 1;
                        val.caption_link = val.caption.replace(/ /g,'-');
                        val.photo_source = getImageURL(val.photo_url);
                        var trend_rendered = Mustache.render(trend_template_html,val);
                        item_list.push(trend_rendered);
                        count += 1;
                    });
                }
            });
            $(trend_item).show();
            $(trend_item).html(item_list.join(''));
        }
        
        function getUrlVars(){
            var vars = [], hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for(var i = 0; i < hashes.length; i++){
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }
        
        //simple contentSwitcher
        function contentSwitcher(settings){
            var settings = {
               contentClass : '.trend-item',
               navigationId : '#trend-navi'
            };
            //Hide all of the content except the first one on the nav
            $(settings.contentClass).not(':first').hide();
            $(settings.navigationId).find('li:first').addClass('active');
            //onClick set the active state, hide the content panels and show the correct one
            $(settings.navigationId).find('a').click(function(e){
                var contentToShow = $(this).attr('href');
                contentToShow = $(contentToShow);
                //dissable normal link behaviour
                e.preventDefault();
                //set the proper active class for active state css
               // $(settings.navigationId).find('li').removeClass('active');
               // $(this).parent('li').addClass('active');
                //hide the old content and show the new
                $(settings.contentClass).hide();
                contentToShow.show();
            });
        }
        
        function renderpageHTML(){
            prefix = get_prefix();
            var pages_json = prefix + "/pages/erinmills-redevelopment.json"
            $.getJSON(pages_json).done(function(data) {
                console.log(data)
                $("#page_title").html(data.title)
                $('#mm_page_content').html(data.body);
                $(".modal-backdrop").remove();
            }).fail(function(jqXHR) {
                if (jqXHR.status == 404) {
                    $("#404_msg").fadeIn("fast");
                }
            }); 
        }
        $('#mm_page_content').on('click', function () {
            console.log('iframe clicked remove');
           $('iframe').removeClass('scrolloff');
        });
        $(".hidden-phone p iframe").mouseleave(function () {
            console.log('iframe clicked add');
           $('iframe').addClass('scrolloff');
        });
        
      
        loadMallDataCached(renderAll); 
    });
</script>