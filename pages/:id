<style>
    #main, .mid_section {
        height: unset !important;
    }
    .site_content_container {
        background: none;
    }
    .h1, .h2, .h3, h1, h2, h3{
        margin-top:0;
    }
    #404_msg{
        display:none;
    }
    
    #mm_page_content span {
        color: black;
        font-family: Helvetica Neue,Helvetica,Arial,sans-serif !important;
    }
    @media only screen and (max-width: 767px) {  
        .site_content_container{
            min-height: 450px;
        }   
        
    }
</style>
<div class="position_relative page_header margin_bottom_none">
        <div class="page_heading"></div>
</div>
<div class="content_container">
    <h4 class="page_heading2" id="page_title"></h4>
    <div class="page_content" id="mm_page_content"></div>
    <div id="directions" class="hidden_now">
        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2891.299371364771!2d-79.71377988451067!3d43.558644679124754!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x882b418a28a8d2a3%3A0x47dbf068950a408d!2sErin%20Mills%20Town%20Centre!5e0!3m2!1sen!2sca!4v1571430924939!5m2!1sen!2sca" width="100%" height="450" frameborder="0" style="border:0;" allowfullscreen=""></iframe>
    </div>
</div>

<script>
    $(document).ready(function() {
        init()
        function renderAll (){
            init_hours();
            var hours = getPropertyHours();
            var all_promos =[];
            $.each( getPromotionsList().reverse() , function( key, val ){
                today = new Date();
                webDate = new Date(val.show_on_web_date);
                if (today >= webDate) {
                    all_promos.push(val);
                } 
            });
            
            var latest_store_event = all_promos[0];
            var latest_mall_event  = getEventsList().sortBy(function(o){ return new Date(o.end_date) })[0];
            var mh=0
            if (latest_mall_event) {
                mh=mh+1;
                renderSideEvents('#latest_mall_event_container', '#latest_mall_event_template', latest_mall_event, 'event');
            }
            if (latest_store_event){
                mh=mh+1
                renderSideEvents('#latest_store_event_container', '#latest_store_event_template', latest_store_event, 'promo');
            } 
            
            // if (mh == 1){
            //     $('.mid_section').css('min-height','920px')
            // } else if (mh>1 && $(window).width() > 767) {
            //     $('.mid_section').css('min-height','1100px')
            // }  
            
            var propertyDetails = getPropertyDetails();
            renderpageHTML();
            $(".modal-backdrop").remove();
        }
        
        function renderpageHTML(){
            var pathArray = window.location.pathname.split( '/' );
            var slug = pathArray[pathArray.length-1];
            prefix = get_prefix();
            var pages_json = prefix + "/pages/" + slug + ".json"
            
            if (pages_json.indexOf('location') > -1) {
                $("#directions").show();
            }
            
            $.getJSON(pages_json).done(function(data) {
                $("#page_title").html(data.title)
                $('#mm_page_content').html(data.body);
            }).fail(function(jqXHR) {
                if (jqXHR.status == 404) {
                    $("#404_msg").fadeIn("fast");
                }
            }); 
        }
        
        $('#mm_page_content').on('click', function () {
            $('iframe').removeClass('scrolloff');
        });
        
        $(".hidden-phone p iframe").mouseleave(function () {
            $('iframe').addClass('scrolloff');
        });
        
        loadMallDataCached(renderAll); 
		
    });
</script>